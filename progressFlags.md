QA Report for src/pages/settings.html

| Bug                                                                                                    | Steps to reproduce                                                                                                                                                                                                                                                                                                     | Evidence                                                                                                                                                                              |
| ------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **CardÂ Inspector flag has no visible effect**                                                          | Enable **CardÂ Inspector** on the settings page, then navigate to ClassicÂ Battle. Expectation from the PRD is that each judoka card shows a collapsible panel with the raw card JSON. No such panel appears under the cards. Scrolling within the card and clicking does nothing.                                       | After enabling the flag and playing a match, no JSON or collapsible inspector appears; the player card only has a scroll bar.                                                         |
| **LayoutÂ DebugÂ Outlines persist across pages after disabling**                                         | Toggle **LayoutÂ DebugÂ Outlines** on (red dashed outlines appear) then off. Navigate to another page (e.g., Classic Battle or SelectÂ MatchÂ Length modal). The outlines persist on the new page even though the flag is off.                                                                                             | After turning off the flag on the settings page, the `SelectÂ MatchÂ Length` modal and battle UI still display red dashed outlines.                                                     |
| **SkipÂ RoundÂ Cooldown doesnâ€™t remove the cooldown**                                                    | Enable **SkipÂ RoundÂ Cooldown** and start a Classic Battle. After selecting a stat, the game still enters a `cooldown` state (visible via the state badge and progress bar). Round transitions are not instantaneous.                                                                                                   | Even with the flag enabled, after choosing a stat the state becomes `cooldown` and a delay occurs before the next round begins.                                                       |
| **BattleÂ StateÂ Progress doesnâ€™t update**                                                               | Turn on **BattleÂ StateÂ Progress** and play a match. The row of numbers appears, but the highlighted number does not change as the state progresses (always shows `4`).                                                                                                                                                 | During multiple rounds the progress bar remained on positionÂ 4 despite state transitions.                                                                                             |
| **CLIÂ Shortcuts disabled leaves players with no clear way to select stats**                            | Disable **CLIÂ Shortcuts** on the settings page and navigate to the battleÂ CLI. The number keys no longer select stats. The CLI expects the user to type commands in the input field, but there is no instruction on the required syntax, effectively making the CLI unusable for players unfamiliar with the commands. | Pressing 1â€“5 in the CLI has no effect after disabling the shortcuts; no moves occur and the player must guess the command syntax.                                                     |
| **OpponentÂ DelayÂ Message appears only in the CLI, not in ClassicÂ Battle**                              | With the flag enabled, the CLI page shows â€œOpponent is choosingâ€¦â€ after a selection. In the Classic battle page this message never appears; the result header jumps straight to the round outcome, so the flag has no visible effect.                                                                                  | In Classic battle no â€œOpponent is choosingâ€¦â€ message is observed between player selection and the result even when the flag is enabled (contrast with CLI evidence).                  |
| **Autoâ€‘Select triggers but still shows state progress stuck at the same number**                       | When the timer expires and autoâ€‘select picks a stat, the battle state progress bar still highlights the same number (4) instead of updating to reflect the state transition.                                                                                                                                           | After autoâ€‘selecting a stat due to timer expiry, the progress indicator remains on 4.                                                                                                 |
| **Accessibility issues:** some toggles are not fully keyboard navigable or labelled for screen readers | Navigating with Tab/Shiftâ€‘Tab sometimes skips toggles or focuses on elements without visible outline. Screen readers read generic labels like â€œcheckboxâ€ rather than flag names, making it hard to know which feature is being toggled.                                                                                | Observed when tabbing through the advanced settings section (no screenshot).                                                                                                          |
| **Performance impact of debug flags**                                                                  | Enabling multiple debug flags (Test Mode, Battle State Badge, Progress, Tooltip Overlay, LayoutÂ Outlines) noticeably slows down page rendering and introduces layout flickering when transitioning between pages.                                                                                                      | When all debug flags were enabled, navigating to Classic Battle resulted in a noticeable lag and redrawn outlines, and memory consumption (observed via browser dev tools) increased. |

Improvement opportunities
Group flags into categories â€“ The advanced settings page lists many flags with no grouping. Organising flags under categories such as Gameplay, Debugging, Accessibility or CLI would improve discoverability. For example, group TestÂ Mode, Autoâ€‘Select, StatÂ Hotkeys and SkipÂ RoundÂ Cooldown under Gameplay, while BattleÂ State Badge, BattleÂ State Progress, LayoutÂ Debug Outlines and Tooltip Overlay Debug belong under Debugging.
Add metadata to settings.json â€“ Extend each flag entry with metadata like stabilityLevel (e.g., experimental, beta, stable), owner (team responsible), lastUpdated timestamp and description. This helps maintainers understand the maturity of a flag and who to contact.
Improve tooltips â€“ Some tooltips are technical (e.g., â€œShow match state sequence below the battle area for testingâ€) whereas others are userâ€‘facing. Distinguish between developer/debug flags and endâ€‘user features. For example, emphasise that StatÂ Hotkeys and Autoâ€‘Select are player convenience features and could be surfaced outside of advanced settings.
Ensure flags persist across pages consistently â€“ Flags correctly persist across page reloads, but turning them off should immediately remove their effects everywhere. A more robust state management system or event bus could help propagate changes across pages and modals.
Provide fallback behaviour or disable access when flags break functionality â€“ When CLIÂ Shortcuts is disabled, provide guidance or disable the CLI page entirely unless the user knows the commands. Similarly, if SkipÂ RoundÂ Cooldown cannot be implemented reliably, remove or hide it until ready.
Expose dataâ€‘feature hooks for test automation â€“ Adding data-feature-id or similar attributes to each flag toggle and to the UI elements they affect would make automated testing easier and ensure toggles can be uniquely identified by tests.
Resolve performance issues â€“ Consider throttling or debouncing debug overlays. The heavy outlines and overlays should not dramatically slow page rendering. Lazyâ€‘load debug features only when they are needed.
Card Inspector improvement â€“ Implement the collapsible JSON panel promised by the PRD. Provide a small Inspect icon on each card that expands to show the cardâ€™s raw stats and attributes in an easily copyable format. Ensure it closes cleanly and does not affect scrolling.
Improve accessibility â€“ Add proper ARIA labels to toggles, ensure focus styles are visible and make screen reader announcements for state changes. Use keyboardâ€‘navigable controls (e.g., accessible toggle components). Provide transcripts for verbose logs.
ğŸ”Â Config & implementation alignment notes
MissingÂ flag in UI â€“ roundStore appears in settings.json with default false, but there is no toggle for it on the settings page. Either remove it from the config or surface it with a description.
TooltipÂ IDs â€“ The settings.json file maps each flag to a tooltip ID, and tooltips appear correctly on the settings page (e.g., tt_cardInspector matches the CardÂ Inspector description). All tooltip IDs referenced in settings.json exist, and there are no orphaned IDs.
Defaults match config â€“ The initial on/off state of each toggle matches the defaults defined in settings.json (e.g., statHotkeys, autoSelect, opponentDelayMessage and cliShortcuts are true by default; all others false).
Stale entries â€“ Apart from roundStore, there are no stale flags in settings.json. However, the skipRoundCooldown flag is implemented in the UI yet has no functional effect â€“ it may be an unfinished feature or misâ€‘named.
Hidden flags â€“ The ability to hide the entire advanced settings panel behind a collapsed accordion works, but there is no mention in the PRD of gating debug flags behind a role. If nonâ€‘developers should not see debug flags, consider reading a role from localStorage and hiding debug flags appropriately.
UI labelling â€“ Some flag names differ slightly from the PRD (e.g., â€œBattle State Badgeâ€ vs. PRD term â€œBattle State Indicatorâ€). Consider harmonising naming between the code, PRD and UI to avoid confusion.