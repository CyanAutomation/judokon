QA Report for src/pages/settings.html

| Bug                                                                                                    | Steps to reproduce                                                                                                                                                                                                                                                                                                     | Evidence                                                                                                                                                                              |
| ------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Card Inspector flag has no visible effect**                                                          | Enable **Card Inspector** on the settings page, then navigate to Classic Battle. Expectation from the PRD is that each judoka card shows a collapsible panel with the raw card JSON. No such panel appears under the cards. Scrolling within the card and clicking does nothing.                                       | After enabling the flag and playing a match, no JSON or collapsible inspector appears; the player card only has a scroll bar.                                                         |
| **Layout Debug Outlines persist across pages after disabling**                                         | Toggle **Layout Debug Outlines** on (red dashed outlines appear) then off. Navigate to another page (e.g., Classic Battle or Select Match Length modal). The outlines persist on the new page even though the flag is off.                                                                                             | After turning off the flag on the settings page, the `Select Match Length` modal and battle UI still display red dashed outlines.                                                     |
| **Skip Round Cooldown doesn’t remove the cooldown**                                                    | Enable **Skip Round Cooldown** and start a Classic Battle. After selecting a stat, the game still enters a `cooldown` state (visible via the state badge and progress bar). Round transitions are not instantaneous.                                                                                                   | Even with the flag enabled, after choosing a stat the state becomes `cooldown` and a delay occurs before the next round begins.                                                       |
| **Battle State Progress doesn’t update**                                                               | Turn on **Battle State Progress** and play a match. The row of numbers appears, but the highlighted number does not change as the state progresses (always shows `4`).                                                                                                                                                 | During multiple rounds the progress bar remained on position 4 despite state transitions.                                                                                             |
| **CLI Shortcuts disabled leaves players with no clear way to select stats**                            | Disable **CLI Shortcuts** on the settings page and navigate to the battle CLI. The number keys no longer select stats. The CLI expects the user to type commands in the input field, but there is no instruction on the required syntax, effectively making the CLI unusable for players unfamiliar with the commands. | Pressing 1–5 in the CLI has no effect after disabling the shortcuts; no moves occur and the player must guess the command syntax.                                                     |
| **Opponent Delay Message appears only in the CLI, not in Classic Battle**                              | With the flag enabled, the CLI page shows “Opponent is choosing…” after a selection. In the Classic battle page this message never appears; the result header jumps straight to the round outcome, so the flag has no visible effect.                                                                                  | In Classic battle no “Opponent is choosing…” message is observed between player selection and the result even when the flag is enabled (contrast with CLI evidence).                  |
| **Auto‑Select triggers but still shows state progress stuck at the same number**                       | When the timer expires and auto‑select picks a stat, the battle state progress bar still highlights the same number (4) instead of updating to reflect the state transition.                                                                                                                                           | After auto‑selecting a stat due to timer expiry, the progress indicator remains on 4.                                                                                                 |
| **Accessibility issues:** some toggles are not fully keyboard navigable or labelled for screen readers | Navigating with Tab/Shift‑Tab sometimes skips toggles or focuses on elements without visible outline. Screen readers read generic labels like “checkbox” rather than flag names, making it hard to know which feature is being toggled.                                                                                | Observed when tabbing through the advanced settings section (no screenshot).                                                                                                          |
| **Performance impact of debug flags**                                                                  | Enabling multiple debug flags (Test Mode, Battle State Badge, Progress, Tooltip Overlay, Layout Outlines) noticeably slows down page rendering and introduces layout flickering when transitioning between pages.                                                                                                      | When all debug flags were enabled, navigating to Classic Battle resulted in a noticeable lag and redrawn outlines, and memory consumption (observed via browser dev tools) increased. |

Improvement opportunities
Group flags into categories – The advanced settings page lists many flags with no grouping. Organising flags under categories such as Gameplay, Debugging, Accessibility or CLI would improve discoverability. For example, group Test Mode, Auto‑Select, Stat Hotkeys and Skip Round Cooldown under Gameplay, while Battle State Badge, Battle State Progress, Layout Debug Outlines and Tooltip Overlay Debug belong under Debugging.
Add metadata to settings.json – Extend each flag entry with metadata like stabilityLevel (e.g., experimental, beta, stable), owner (team responsible), lastUpdated timestamp and description. This helps maintainers understand the maturity of a flag and who to contact.
Improve tooltips – Some tooltips are technical (e.g., “Show match state sequence below the battle area for testing”) whereas others are user‑facing. Distinguish between developer/debug flags and end‑user features. For example, emphasise that Stat Hotkeys and Auto‑Select are player convenience features and could be surfaced outside of advanced settings.
Ensure flags persist across pages consistently – Flags correctly persist across page reloads, but turning them off should immediately remove their effects everywhere. A more robust state management system or event bus could help propagate changes across pages and modals.
Provide fallback behaviour or disable access when flags break functionality – When CLI Shortcuts is disabled, provide guidance or disable the CLI page entirely unless the user knows the commands. Similarly, if Skip Round Cooldown cannot be implemented reliably, remove or hide it until ready.
Expose data‑feature hooks for test automation – Adding data-feature-id or similar attributes to each flag toggle and to the UI elements they affect would make automated testing easier and ensure toggles can be uniquely identified by tests.
Resolve performance issues – Consider throttling or debouncing debug overlays. The heavy outlines and overlays should not dramatically slow page rendering. Lazy‑load debug features only when they are needed.
Card Inspector improvement – Implement the collapsible JSON panel promised by the PRD. Provide a small Inspect icon on each card that expands to show the card’s raw stats and attributes in an easily copyable format. Ensure it closes cleanly and does not affect scrolling.
Improve accessibility – Add proper ARIA labels to toggles, ensure focus styles are visible and make screen reader announcements for state changes. Use keyboard‑navigable controls (e.g., accessible toggle components). Provide transcripts for verbose logs.
🔍 Config & implementation alignment notes
Missing flag in UI – roundStore appears in settings.json with default false, but there is no toggle for it on the settings page. Either remove it from the config or surface it with a description.
Tooltip IDs – The settings.json file maps each flag to a tooltip ID, and tooltips appear correctly on the settings page (e.g., tt_cardInspector matches the Card Inspector description). All tooltip IDs referenced in settings.json exist, and there are no orphaned IDs.
Defaults match config – The initial on/off state of each toggle matches the defaults defined in settings.json (e.g., statHotkeys, autoSelect, opponentDelayMessage and cliShortcuts are true by default; all others false).
Stale entries – Apart from roundStore, there are no stale flags in settings.json. However, the skipRoundCooldown flag is implemented in the UI yet has no functional effect – it may be an unfinished feature or mis‑named.
Hidden flags – The ability to hide the entire advanced settings panel behind a collapsed accordion works, but there is no mention in the PRD of gating debug flags behind a role. If non‑developers should not see debug flags, consider reading a role from localStorage and hiding debug flags appropriately.
UI labelling – Some flag names differ slightly from the PRD (e.g., “Battle State Badge” vs. PRD term “Battle State Indicator”). Consider harmonising naming between the code, PRD and UI to avoid confusion.