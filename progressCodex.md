# QA Report: JU‑DO‑KON! Classic Battle (battleClassic.html)

## Issues Found
| #      | Issue                                                                                                                                                                                                                                                                 | Steps to reproduce                                                                                                                                                                   |
| ------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **1**  | **Inconsistent match‑length modal** – After quitting or replaying, the match‑length selection dialog sometimes does not appear; the page shows Round 0 with an empty battle area and no way to start a match.                                                         | Navigate to `battleClassic.html`; observe modal. Select a length and then quit. Return to `battleClassic.html` via the navbar; the modal is missing and the match cannot be started. |
| **2**  | **Cards never displayed** – The player and opponent cards defined in the PRD are never shown.  Only a list of stat buttons (power, speed, technique, kumikata, newaza) appears; no judoka art or values are visible.                                                  | Start a match and observe the battle area throughout multiple rounds: cards are never rendered.                                                                                      |
| **3**  | **Selection timer doesn’t work** – The scoreboard displays “Time Left: 30s” but the value never counts down.  After selecting a stat, the text changes to “3 s” but still does not decrement.  This also prevents the auto‑selection on timeout described in the PRD. | Start a match.  Observe that Time Left stays at 30 s even after waiting >30 s.  Choose a stat; the text becomes “3 s” and stays static.                                              |
| **4**  | **Auto‑select never triggers** – Because the timer doesn’t decrement, the `autoSelect` feature flag never triggers a stat choice on timeout; the player must click a stat or “Next” manually.                                                                         | Let the 30‑s timer expire without clicking any stat.  No stat is auto‑selected; the round does not progress.                                                                         |
| **5**  | **Scoreboard fails to update** – After winning the first round the score reads “You: 1 Opponent: 0”. Selecting further stats does not change the score or show round results (“You picked: …”, “You win/lose/draw”).                                                  | Win one round (select any stat).  Note the score is 1‑0.  Select another stat and click **Next**; the score remains 1‑0 and no result message appears.                               |
| **6**  | **Round numbering increments by two** – Pressing **Next** advances the round counter by two (e.g., Round 2 → Round 4 → Round 6).                                                                                                                                      | During a match, click **Next** repeatedly; notice the round number jumps by two instead of one.                                                                                      |
| **7**  | **Replay does not reset state** – The **Replay** button resets the round number but not the scores.  In the end‑of‑match modal, clicking **Replay** navigates to `index.html` instead of restarting the Classic Battle.                                               | During a match, click **Replay**; round resets to 1 but scores persist.  Quit the match and click **Replay** in the final modal; you are redirected to the home menu.                |
| **8**  | **End‑condition messaging is contradictory** – Quitting early shows a “Match Over – It’s a draw! (1‑0)” modal while the scoreboard says “You quit the match. You lose!”.  The draw text conflicts with the score and losing message.                                  | Start a match, win a round, then quit via the Quit confirmation.  Note the modal text vs the scoreboard text.                                                                        |
| **9**  | **Broken navigation link** – The bottom navigation bar’s Classic Battle link points to `battleJudoka.html`, which returns a 404.  This makes it hard to return to the mode after leaving.                                                                             | Click **Classic Battle** in the bottom nav; you see a GitHub Pages 404 error for `battleJudoka.html`.                                                                                |
| **10** | **Missing ARIA roles and descriptions** – There is no observable `aria-live` or `role="status"` on the scoreboard, and stat buttons lack `aria-describedby`.  Screen‑reader support is likely inadequate.                                                             | Inspect elements or rely on screen readers; no announcements occur when focusing stat buttons or updating scores.                                                                    |
| **11** | **Keyboard shortcuts advertised but not working** – The modal suggests using number keys 1–3 or arrow keys to select match length, but these keys have no effect.                                                                                                     | On the match‑length modal, press keys 1–3 or arrow keys; nothing happens.                                                                                                            |
| **12** | **Opponent AI and difficulty not visible** – Opponent stat choice never appears, and there is no setting for Easy/Medium/Hard difficulty.                                                                                                                             | Play multiple rounds; there is no “Opponent is choosing…” message or difficulty selector.                                                                                            |
| **13** | **State‑progress and debug features absent** – The debug panel, seed control, and battle state progress list mentioned in the PRD are not present or accessible.                                                                                                      | There is no toggle to enable test mode; no visible debug output.                                                                                                                     |
| **14** | **“Next” always enabled** – The **Next** button is clickable even before selecting a stat, contrary to the PRD which states it should be used to skip cooldown after results.                                                                                         | At the start of a round, observe that **Next** is enabled and increments rounds without selecting a stat.                                                                            |
| **15** | **Modal doesn’t trap focus** – When the Quit confirmation modal is open, background buttons remain clickable and `Tab` focus can move outside the modal.                                                                                                              | Open Quit confirmation.  Click a stat button behind the modal or press `Tab` to cycle focus; background elements remain interactive.                                                 |
| **16** | **Tooltip formatting** – Tooltips on match‑length buttons contain the literal escape sequence `\n` instead of a line break.                                                                                                                                           | Hover over the **Quick** button; the tooltip shows `Quick\nFirst to 5 points wins.` instead of a new line.                                                                           |

Improvement opportunities
Implement full state machine – Ensure the UI binds to the battle engine’s state transitions (init → selection → opponent choose → resolution → cooldown → next round → end). This will automatically handle timers, card reveals and scoring.
Render cards correctly – Use card components that show judoka portraits and their stats; reveal the opponent’s card after the player picks a stat.
Fix timers and auto‑select – Use setInterval/requestAnimationFrame to update the 30‑second selection timer in real time and auto‑pick a stat when it expires. Pause and resume based on tab visibility.
Reset state on replay – Clear round number, scores and deck when the player presses Replay or chooses a new match length.
Correct round increments – Increment the round by one per completed round. The Next button should only be available during the cooldown phase, not during selection.
Clarify end messages – Show clear outcomes (Win/Loss/Draw) with consistent score representation in both the scoreboard and end modal.
Add ARIA and keyboard support – Implement aria-live="polite" on the scoreboard and aria-describedby on stat buttons. Trap focus within modals and support number‑key shortcuts when statHotkeys is enabled. Provide proper alt text for cards.
Repair navigation paths – Update the bottom navigation to point to the correct Classic Battle URL (battleClassic.html). Provide a header link to return to the main menu.
Offer AI difficulty – Provide a difficulty selector (Easy/Medium/Hard) with default Easy; adjust AI logic accordingly.
Add debug/test modes – Expose the debug panel and state‑progress list behind feature flags. Allow testers to set seeds and view deterministic outputs.
Improve tooltips – Replace the literal \n with <br> or separate nodes so tooltips read naturally.
Ensure responsive layout and contrast – Use responsive design to reposition cards on small screens and verify colour contrast meets WCAG 2.1 AA (≥4.5:1). Test at 200 % zoom and on low‑spec devices.
Add audio/visual feedback – Use subtle animations and sound cues when a card wins or loses to keep young players engaged.