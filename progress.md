# QA Report: `battleClassic.html` Review

## Identified Issues

| Issue                                          | Steps to reproduce                                                                                                                                                                                                                                                                                                                                                                      | Impact                                                                                                                                                                                                                                                                                                                                               |
| :--------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Battle never starts – stuck at “Waiting…”**  | 1. Navigate to `battleClassic.html`.<br>2. Select any match length (Quick, Medium or Long). The modal closes and a blue label indicates the chosen win target.<br>3. Observe the scoreboard: it displays “Waiting… Round 0” and shows “You: 0 Opponent: 0”. No cards appear in the battle area and the **Next** button remains disabled; the game never progresses beyond this state. | This is a critical defect. The core loop (draw card → select stat → resolve round) cannot be exercised. It prevents verification of nearly all functional requirements (stat selection, scoring, AI difficulty, timers, end‑game conditions). It likely stems from a JavaScript error or missing resource (the engine appears not to initialise). |
| **Clickable area mis‑targets**                 | When selecting the match length modal, clicking near the bottom of the Quick button sometimes navigates to an unrelated page (e.g., opens `judoka.json` via `raw.githubusercontent.com`). This happened on an earlier attempt when a click at y≈530 mis‑fired and loaded a different page.                                                                                              | Unexpected navigation confuses players and suggests that UI elements may overlap or that there are invisible links capturing clicks. It also complicates keyboard/mouse targeting for children.                                                                                                                                                     |
| **Keyboard selection does not work**           | The modal instructions state that number keys (1–3) or arrow keys can select an option. Pressing “1” or pressing arrow keys had no effect—only a mouse click dismissed the modal.                                                                                                                                                                                                      | Inconsistent keyboard support reduces accessibility, especially for players who cannot use a mouse. The PRD lists keyboard navigation as an accessibility requirement.                                                                                                                                                                              |
| **Missing stat buttons and card visuals**      | After closing the modal, neither the player’s nor opponent’s cards render. The `#stat-buttons` container remains empty and the `data-buttons-ready` attribute never switches to `true`.                                                                                                                                                                                                | Without visible cards or stat buttons, players cannot choose stats. This also prevents screen readers from describing stats, so the accessibility of the stat selection cannot be judged.                                                                                                                                                           |
| **Scoreboard timer never displays**            | The `#next-round-timer` region remains blank while the scoreboard header always says “Waiting…”. The 30 s stat selection timer is never shown, and the countdown/cool‑down flows cannot be evaluated.                                                                                                                                                                                  | Cannot verify auto‑select on timeout, timer pausing on tab change or drift detection.                                                                                                                                                                                                                                                                |
| **No opponent action feedback**                | Since rounds never start, there is never an “Opponent is choosing…” message or reveal delay.                                                                                                                                                                                                                                                                                            | Opponent behaviour and AI difficulty settings cannot be validated.                                                                                                                                                                                                                                                                                   |
| **Quit flow unreachable**                      | The “Quit” button is displayed but since a match never actually begins, there is no confirmation modal nor return to home screen logic to test.                                                                                                                                                                                                                                         | The PRD requires a quit confirmation with no penalty, but this cannot be confirmed.                                                                                                                                                                                                                                                                  |
| **Footer navigation accessible but breakable** | The bottom navigation bar is fully active during the match. Clicking it mid‑match navigates away from the battle without any confirmation, even though the PRD indicates a confirmation step.                                                                                                                                                                                          | Players can accidentally leave a match without confirmation, causing progress loss. The nav bar should be disabled or intercepted during battles.                                                                                                                                                                                                   |

## Improvement Opportunities

* **Fix the battle initialisation bug.** The most pressing issue is that the battle engine doesn’t start. Investigate whether the client fails to load `battleClassic.init.js`, the judoka dataset, or dependencies. Add error handling around asynchronous imports and surface any fatal errors in the UI (e.g., display a snackbar with a retry button).
* **Ensure keyboard support for match‑length selection.** The modal’s instructions claim number and arrow keys work, but they currently don’t. Hook keyboard events properly and focus the first button when the modal opens.
* **Improve click‑target spacing.** The mis‑navigation suggests invisible clickable elements near the Quick button. Increase spacing and ensure the modal intercepts pointer events. Touch targets should be ≥ 44 px high as per the PRD.
* **Disable or intercept footer navigation during battles.** To prevent accidental exits, hide or disable the bottom nav bar once a match begins, or add a confirmation modal when navigation is attempted.
* **Add accessible descriptions to stat buttons.** The PRD specifies `aria-describedby` attributes for stat buttons explaining the meaning of each stat. These should be included in the dynamically created buttons to assist screen‑reader users.
* **Provide visual feedback when selecting stats.** When the core loop is operational, ensure that selected buttons highlight and the chosen stat is announced both visually and via the scoreboard. This will help young players understand cause and effect.
* **Expose test hooks and deterministic mode.** The PRD lists `enableTestMode` and `battleStateProgress` flags. Document how to enable these via query parameters or global overrides so QA testers can simulate deterministic outcomes and inspect state transitions without randomisation.
* **Consider audio cues.** Although optional, short sound effects for wins, losses and ties (with mute option) would enhance engagement for children.
* **Optimise for low‑end devices.** Use CSS transitions rather than heavy JavaScript for animations, limit the size of card images and compress assets to ensure the game runs smoothly on low‑spec devices. Use `prefers-reduced-motion` media query to disable animations for users who prefer less motion.
* **Add robust error recovery.** Implement user‑facing error screens for dataset load failures, timer drift (> 2 s), or other unexpected errors. Provide a “Retry” button to reload the match without requiring a full page refresh.
