<!doctype html>
<html lang="en">
  <head>
    <script
      src="https://js-de.sentry-cdn.com/d5c65640106080845226e89b9a1f589c.min.js"
      crossorigin="anonymous"
    ></script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="JU-DO-KON! Classic Battle - CLI mode" />
    <title>JU-DO-KON! - Classic Battle CLI</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../styles/components.css" />
    <link rel="stylesheet" href="battleCLI.css" />
  </head>
  <body>
    <div class="terminal-title-bar">bash - JU-DO-KON</div>
    <a href="#cli-main" class="skip-link">Skip to main content</a>
    <div id="cli-root" class="cli-root" data-round="0" data-target="0" data-test="cli-root">
      <header id="cli-header" class="cli-header" role="banner">
        <div class="cli-title">
          <a href="../../index.html" data-testid="home-link" aria-label="Return to home">Home</a>
          &nbsp;|&nbsp; Classic Battle (CLI)
          <span
            id="verbose-indicator"
            class="verbose-indicator"
            aria-live="polite"
            aria-hidden="true"
            style="display: none"
          >
            Verbose ON
          </span>
          <span
            id="battle-state-badge"
            data-flag="battleStateBadge"
            class="state-badge"
            style="display: none"
            >State: -</span
          >
        </div>
        <!-- header title + status only; controls moved into main.settings for less prominence -->
        <div class="cli-status" aria-live="polite" aria-atomic="true">
          <div id="cli-round"></div>
          <div
            id="cli-score"
            data-score-player="0"
            data-score-opponent="0"
            aria-live="polite"
            aria-atomic="true"
          >
            You: 0 Opponent: 0
          </div>
        </div>

        <!-- Standard Scoreboard DOM nodes (Phase 1: hidden, for future shared component) -->
        <div class="standard-scoreboard-nodes" style="display: none" aria-hidden="true">
          <p id="next-round-timer" aria-atomic="true" role="status"></p>
          <p id="round-counter" aria-atomic="true">Round 0</p>
          <p id="score-display" aria-live="off" aria-atomic="true">You: 0 Opponent: 0</p>
        </div>
      </header>

      <main id="cli-main" class="cli-main" role="main">
        <section aria-label="Round Status" class="cli-block">
          <div id="round-message" role="status" aria-live="polite" aria-atomic="true"></div>
          <div
            id="cli-countdown"
            role="status"
            aria-live="polite"
            aria-atomic="true"
            data-remaining-time="0"
          ></div>
        </section>

        <!-- Less-prominent settings section moved into main to reduce header prominence -->
        <details id="cli-settings" class="cli-block cli-settings" aria-label="Match Settings" open>
          <summary class="cli-settings-summary" data-testid="settings-summary">
            <span class="fw-600">Match Settings</span>
          </summary>
          <div id="cli-settings-body" class="cli-settings-body">
            <fieldset class="cli-settings-group">
              <legend class="cli-settings-group__title">Match rules</legend>
              <div class="cli-settings-row">
                <label for="points-select">Win target:</label>
                <select
                  id="points-select"
                  aria-label="Points to win"
                  data-tooltip-id="settings.pointsToWin"
                >
                  <option value="3">3</option>
                  <option value="5">5</option>
                  <option value="10">10</option>
                </select>
              </div>
            </fieldset>
            <fieldset class="cli-settings-group">
              <legend class="cli-settings-group__title">Display &amp; logging</legend>
              <div class="cli-settings-row">
                <label for="verbose-toggle">Verbose:</label>
                <input
                  id="verbose-toggle"
                  type="checkbox"
                  aria-label="Toggle verbose logging"
                  data-flag="cliVerbose"
                />
              </div>
            </fieldset>
            <fieldset class="cli-settings-group">
              <legend class="cli-settings-group__title">Advanced</legend>
              <p class="cli-settings-group__hint" id="cli-seed-hint">
                Provide a seed to replay the same matchup. Leave blank for random battles.
              </p>
              <div class="cli-settings-row">
                <label for="seed-input">Seed:</label>
                <div class="d-flex flex-col">
                  <input
                    id="seed-input"
                    type="number"
                    inputmode="numeric"
                    aria-label="Deterministic seed (optional)"
                    aria-describedby="seed-error cli-seed-hint"
                    class="seed-input"
                  />
                  <div id="seed-error" class="seed-error"></div>
                </div>
              </div>
            </fieldset>
          </div>
        </details>

        <section aria-label="Stat Selection" class="cli-block">
          <div
            id="cli-stats"
            role="listbox"
            tabindex="0"
            aria-label="Select a stat with number keys 1-5"
            aria-busy="true"
          >
            <!-- Skeleton placeholders to stabilize layout and tests -->
            <div
              class="cli-stat skeleton"
              role="presentation"
              style="display: flex; min-height: 44px"
            >
              (1) --------------------
            </div>
            <div
              class="cli-stat skeleton"
              role="presentation"
              style="display: flex; min-height: 44px"
            >
              (2) --------------------
            </div>
            <div
              class="cli-stat skeleton"
              role="presentation"
              style="display: flex; min-height: 44px"
            >
              (3) --------------------
            </div>
            <div
              class="cli-stat skeleton"
              role="presentation"
              style="display: flex; min-height: 44px"
            >
              (4) --------------------
            </div>
            <div
              class="cli-stat skeleton"
              role="presentation"
              style="display: flex; min-height: 44px"
            >
              (5) --------------------
            </div>
          </div>
        </section>

        <details
          aria-label="Shortcuts"
          id="cli-shortcuts"
          class="cli-block cli-settings"
          data-flag="cliShortcuts"
        >
          <summary
            class="cli-settings-summary cli-shortcuts-summary"
            aria-controls="cli-shortcuts-body"
          >
            <span class="fw-600">Shortcuts</span>
            <span class="cli-shortcuts-summary-hint" aria-hidden="true">Press H to toggle</span>
          </summary>
          <div id="cli-shortcuts-body" class="cli-shortcuts-body">
            <div class="cli-settings-header d-flex align-items-center justify-content-between">
              <div class="fw-600" aria-hidden="true">Shortcuts</div>
              <div>
                <button
                  id="cli-shortcuts-close"
                  aria-label="Close help"
                  aria-controls="cli-shortcuts-body"
                  aria-expanded="false"
                  class="button-reset"
                  type="button"
                >
                  [X]
                </button>
              </div>
            </div>
            <ul id="cli-help">
              <li>[1–5] Select Stat</li>
              <li>[Enter] or [Space] Next</li>
              <li>[Q] Quit</li>
              <li>[H] Toggle Help</li>
            </ul>
          </div>
        </details>

        <section
          aria-label="Verbose Log"
          id="cli-verbose-section"
          class="cli-block"
          data-flag="cliVerbose"
          hidden
        >
          <pre id="cli-verbose-log" aria-atomic="false" class="pre-wrap" tabindex="-1"></pre>
        </section>
        <div id="cli-prompt" role="status" aria-label="Command prompt">
          &gt; <span id="cli-cursor" aria-label="Cursor">_</span>
        </div>
      </main>

      <footer class="cli-footer" role="contentinfo">
        <div
          id="cli-controls-hint"
          class="cli-controls-hint"
          role="note"
          aria-live="polite"
          aria-describedby="cli-controls-hint-announce"
          hidden
        >
          <span class="cli-controls-hint__title" aria-hidden="true">Shortcuts</span>
          <div class="cli-controls-hint__items" aria-hidden="true">
            <span class="cli-controls-hint__item" data-requires="cliShortcuts statHotkeys">
              <span class="cli-controls-hint__key" id="cli-controls-key-range">1–5</span>
              <span class="cli-controls-hint__action">Select stat</span>
            </span>
            <span class="cli-controls-hint__item" data-requires="cliShortcuts">
              <span class="cli-controls-hint__key">Enter/Space</span>
              <span class="cli-controls-hint__action">Continue</span>
            </span>
            <span class="cli-controls-hint__item" data-requires="cliShortcuts">
              <span class="cli-controls-hint__key">H</span>
              <span class="cli-controls-hint__action">Toggle help</span>
            </span>
            <span class="cli-controls-hint__item">
              <span class="cli-controls-hint__key">Q</span>
              <span class="cli-controls-hint__action">Quit match</span>
            </span>
          </div>
          <span id="cli-controls-hint-announce" class="sr-only"
            >Use keys 1 through 5 to choose a stat, Enter or Space to continue, H to toggle help,
            and Q to quit.</span
          >
        </div>
        <p
          id="cli-shortcuts-disabled-hint"
          class="cli-controls-hint__fallback"
          role="note"
          aria-live="polite"
          hidden
        >
          Keyboard shortcuts are disabled. Type commands like
          <span class="cli-controls-hint__key">stat 1</span> or
          <span class="cli-controls-hint__key">stat 2</span> to choose a stat.
        </p>
        <!-- Terminal-style snackbar container anchored at the bottom -->
        <div id="snackbar-container">
          <!-- snackbar.js will populate .snackbar elements here; in CLI this renders as a single bottom line. -->
        </div>
      </footer>
      <!-- Hidden containers for compatibility with classic battle DOM queries -->
      <div id="player-card" style="display: none"></div>
      <div id="opponent-card" style="display: none"></div>
      <div id="modal-container"></div>
      <script type="module" src="battleCLI.init.js"></script>
    </div>
  </body>
</html>
