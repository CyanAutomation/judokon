<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="JU-DO-KON! Classic Battle – CLI mode" />
    <title>JU-DO-KON! – Classic Battle CLI</title>
    <style>
      :root {
        color-scheme: light dark;
      }
      html,
      body {
        height: 100%;
        margin: 0;
      }
      body {
        font-family:
          ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New",
          monospace;
        background: #0b0c0c;
        color: #f2f2f2;
      }
      .cli-root {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }
      .cli-header {
        padding: 8px 12px;
        border-bottom: 1px solid #3a3a3a;
        display: flex;
        justify-content: space-between;
        align-items: center; /* prevent height changes from baseline shifts */
        box-sizing: border-box; /* include padding in fixed height */
        height: 56px; /* hard cap header height for consistency */
      }
      .cli-title {
        font-weight: 700;
      }
      .state-badge {
        font-size: 12px;
        opacity: 0.8;
        margin-left: 8px;
        display: inline-block;
        min-width: 30ch; /* reserve width for longest state (prevents wrap/jump) */
        white-space: nowrap;
      }
      .cli-controls {
        display: flex;
        gap: 8px;
        align-items: center;
      }
      .cli-main {
        flex: 1;
        display: flex;
        flex-direction: column;
        padding: 12px;
        gap: 12px;
      }
      .cli-block {
        padding: 8px 10px;
        border: 1px solid #2a2a2a;
      }
      /* Reserve space for round message to prevent layout jump */
      #round-message {
        min-height: 1.4em; /* ~1 line of monospace text */
      }
      /* Make verbose section scrollable so newest entries are visible */
      #cli-verbose-log {
        max-height: 35vh;
        overflow-y: auto;
      }
      #cli-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 6px;
      }
      .cli-stat {
        padding: 4px 6px;
        background: #121212;
        border: 1px solid #3a3a3a;
      }
      .cli-stat.selected {
        border-color: #9ad1ff;
        background: #1a1a1a;
      }
      .cli-status {
        text-align: right;
        white-space: pre;
      }
      #cli-help {
        margin: 0;
        padding-left: 16px;
      }
      .cli-footer {
        margin-top: auto;
        border-top: 1px solid #3a3a3a;
      }
      /* Terminal-style snackbar line at the bottom */
      #snackbar-container {
        padding: 8px 12px;
        background: #111;
        color: #e6e6e6;
      }
      #snackbar-container .snackbar {
        display: block;
      }
      /* Ensure good contrast for links if any appear */
      a {
        color: #9ad1ff;
      }
      a:focus,
      [tabindex]:focus {
        outline: 2px solid #9ad1ff;
        outline-offset: 2px;
      }
    </style>
  </head>
  <body>
    <div id="cli-root" class="cli-root" data-round="0">
      <header id="cli-header" class="cli-header" role="banner">
        <div class="cli-title">
          <a href="../../index.html" data-testid="home-link" aria-label="Return to home">Home</a>
          &nbsp;|&nbsp; Classic Battle (CLI)
          <span
            id="battle-state-badge"
            data-flag="battleStateBadge"
            class="state-badge"
            aria-live="polite"
            style="display: none"
            >State: —</span
          >
        </div>
        <div class="cli-controls" role="group" aria-label="Match Settings">
          <label for="points-select">Win target:</label>
          <select
            id="points-select"
            aria-label="Points to win"
            data-tooltip-id="settings.pointsToWin"
          >
            <option value="5">5</option>
            <option value="10" selected>10</option>
            <option value="15">15</option>
          </select>
          <label for="verbose-toggle">Verbose:</label>
          <input id="verbose-toggle" type="checkbox" aria-label="Toggle verbose logging" />
          <label for="seed-input">Seed:</label>
          <input
            id="seed-input"
            type="number"
            inputmode="numeric"
            aria-label="Deterministic seed (optional)"
            style="width: 6ch"
          />
        </div>
        <div class="cli-status" aria-live="polite" aria-atomic="true">
          <div id="cli-round">Round 0 of 0</div>
          <div id="cli-score">You: 0 Opponent: 0</div>
        </div>
      </header>

      <main id="cli-main" class="cli-main" role="main">
        <section aria-label="Round Status" class="cli-block">
          <div id="round-message" role="status" aria-live="polite" aria-atomic="true"></div>
          <div id="cli-countdown" role="status" aria-live="polite" data-remaining-time="0"></div>
        </section>

        <section aria-label="Stat Selection" class="cli-block">
          <div
            id="cli-stats"
            role="listbox"
            tabindex="0"
            aria-label="Select a stat with number keys 1–5"
          >
            <!-- Populated from statNames.json at runtime as [n] Label -->
          </div>
        </section>

        <section aria-label="Shortcuts" id="cli-shortcuts" class="cli-block">
          <ul id="cli-help">
            <li>[1–5] Select Stat</li>
            <li>[Enter]/[Space] Next</li>
            <li>[Q] Quit</li>
            <li>[H] Toggle Help</li>
            <li>[R] Retro Mode</li>
          </ul>
        </section>

        <section aria-label="Verbose Log" id="cli-verbose-section" class="cli-block" hidden>
          <pre
            id="cli-verbose-log"
            aria-live="polite"
            aria-atomic="false"
            style="margin: 0; white-space: pre-wrap"
          ></pre>
        </section>
      </main>

      <footer class="cli-footer" role="contentinfo">
        <!-- Terminal-style snackbar container anchored at the bottom -->
        <div id="snackbar-container">
          <!-- snackbar.js will populate .snackbar elements here; in CLI this renders as a single bottom line. -->
        </div>
      </footer>
      <!-- Hidden containers for compatibility with classic battle DOM queries -->
      <div id="player-card" style="display: none"></div>
      <div id="opponent-card" style="display: none"></div>
      <div id="modal-container"></div>
      <script type="module" src="../pages/battleCLI.js"></script>
    </div>
  </body>
</html>
