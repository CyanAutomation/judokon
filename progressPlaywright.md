| rank | file                                                   | total | segment      | intent | relevance | assertion | robustness | cost | duration(ms) | retries | quick\_fix                                                                                                                                                                                                                                                                |
| ---- | ------------------------------------------------------ | ----- | ------------ | ------ | --------- | --------- | ---------- | ---- | ------------ | ------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1    | `playwright/hover-zoom.spec.js`                        | 1     | REMOVE/MERGE | 1      | 0         | 0         | 0          | 0    | 551          | 0       | Relies on `waitForTimeout` sleeps and even `expect(true).toBe(true)` fallbacks, so the zoom never has to work; wait on `data-enlarged`/size changes with semantic locators and drop the hard sleeps to assert real hover growth.\:codex-file-citation:codex-file-citation |
| 2    | `playwright/battle-cli-play.spec.js`                   | 1     | REMOVE/MERGE | 1      | 0         | 0         | 0          | 0    | –            | –       | Finish a round through the real UI or deterministic test API instead of calling `window.__test.handleRoundResolved`, then assert the scoreboard/snackbar text for that round.\:codex-file-citation                                                                        |
| 3    | `playwright/battle-cli-restart.spec.js`                | 2     | REMOVE/MERGE | 1      | 0         | 1         | 0          | 0    | –            | –       | End the match via supported user flows (or Test API) rather than `window.__test.handleMatchOver`, and verify the new match resets scores and hides the replay prompt.\:codex-file-citation                                                                                |
| 4    | `playwright/battle-classic/opponent-reveal.spec.js`    | 3     | REMOVE/MERGE | 1      | 1         | 1         | 0          | 0    | 2037         | 0       | Replace layered `waitForTimeout` delays with waits on snackbar/score state and prune overlapping scenarios so each case validates a distinct user-visible opponent reveal path.\:codex-file-citation:codex-file-citation                                                  |
| 5    | `playwright/battle-classic/end-modal.spec.js`          | 3     | REMOVE/MERGE | 1      | 1         | 1         | 0          | 0    | 1751         | 0       | Stop sleeping for seconds after match end; instead await the modal/end-game promise and assert the replay dialog content and actions rather than generic body/header visibility.\:codex-file-citation:codex-file-citation                                                 |
| 6    | `playwright/cli.spec.mjs`                              | 3     | REMOVE/MERGE | 1      | 0         | 1         | 1          | 0    | 230          | 0       | Exercise countdown/focus through public controls instead of mutating DOM or relying on `__battleCLIinit` fallbacks so regressions surface through user behavior.\:codex-file-citation                                                                                     |
| 7    | `playwright/cli-flows.spec.mjs`                        | 3     | REMOVE/MERGE | 1      | 0         | 1         | 1          | 0    | 226          | 0       | Expand keyboard flow checks to expect concrete UI effects (help text, quit modal, verbose output) instead of merely verifying `#cli-root` stays visible after each key press.\:codex-file-citation                                                                        |
| 8    | `playwright/battle-next-skip.non-orchestrated.spec.js` | 4     | REMOVE/MERGE | 2      | 0         | 1         | 1          | 0    | 662          | 0       | Recreate cooldown skipping through the normal orchestrated flow and public events rather than injecting event targets and enabling the Next button manually.\:codex-file-citation                                                                                         |
| 9    | `playwright/cli.spec.js`                               | 4     | REMOVE/MERGE | 1      | 0         | 1         | 2          | 0    | 573          | 0       | Drive countdown/focus with accessible UI interactions rather than invoking `window.__battleCLIinit` helpers so failures reflect user-visible regressions.\:codex-file-citation                                                                                            |
| 10   | `playwright/battle-classic/timer.spec.js`              | 5     | REFACTOR     | 2      | 1         | 1         | 0          | 1    | 449          | 0       | Swap the two `waitForTimeout` polls for expectations tied to the countdown element or test API hooks so the timer is asserted deterministically without idle delays.\:codex-file-citation                                                                                 |

Common problems
Many CLI specs bypass real behavior by calling internal helpers like window.__test or __battleCLIinit, so they never prove the user flow works end-to-end.
Heavy use of page.waitForTimeout introduces brittle timing and multi-second runtimes without asserting the actual events that should unblock the flow.
Several tests assert only generic visibility or placeholder truths (expect(true).toBe(true)), so real regressions could slip by unnoticed.
Two CLI specs (battle-cli-play and battle-cli-restart) didn’t appear in the latest Playwright JSON report, suggesting they’re excluded from the executed suite and lack runtime signal entirely.
Repo-wide fixes
Standardize on the deterministic Test API/public UI interactions for battle/CLI flows and forbid direct use of window.__test/__battleCLIinit in tests, so coverage matches what users experience.
Enforce a lint or helper wrapper to eliminate page.waitForTimeout, replacing it with expect/promise-based waits tied to actual UI state (snackbar text, timers, modals).
Require meaningful assertions (text/ARIA/URL) and forbid placeholder expectations, especially in hover/CLI suites, so each test fails on genuine regressions.
Ensure every spec is registered with the Playwright runner (or delete dead files) so the JSON report covers the entire Playwright surface and slow/flake metrics stay trustworthy.