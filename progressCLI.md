QA Report for src/pages/battleCLI.html

| Issue                                                                                                                                                                                                           | Steps to reproduce                                                                                                                                                                                                                                                                                                   | Impact                                                                                                            |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------- |
| **Unintuitive start of match** – there is no obvious “Start match” button. Users must click a small yellow power icon with no label; pressing keyboard shortcuts shows “Invalid key” until the icon is clicked. | Load CLI page and set seed/win target. Pressing any key results in “Invalid key” hint. Only clicking the tiny power symbol starts the match; the PRD envisioned a prominent start action.                                                                                                                            | Poor discoverability; keyboard‑only users may be confused because initial key presses are rejected.               |
| **Missing match length option (3 points)** – the win target selector only offers 5, 10 and 15 points.                                                                                                           | Inspect the “Win target” dropdown; available values are 5, 10, 15. The PRD specifies options 3, 5, 10.                                                                                                                                                                                                               | Divergence from PRD; players cannot select a 3‑point quick match.                                                 |
| **Seed determinism unreliable** – starting multiple matches with the same seed yields different stat values in the first round.                                                                                 | Enter seed `42`, set win target to 5, start a match and record the first round stats (e.g., Power = 8, Speed = 8, Technique = 8, Kumi‑kata = 7, Ne‑waza = 8). Quit to lobby, return to CLI, re‑enter seed 42 and start a new match. The first round values change (e.g., Power = 7, Speed = 8, Technique = 6, etc.). | Violates deterministic seed requirement; undermines repeatability needed for QA and automation.                   |
| **Settings persistence not implemented** – win target and seed reset on page reload.                                                                                                                            | Choose win target 5 and seed 42, reload the page (Ctrl+R). Both values revert to defaults (win target 10, blank seed). The PRD expects persistence via localStorage.                                                                                                                                                 | Users must re‑enter preferences each session; automated tests cannot rely on stored settings.                     |
| **Timer does not pause when tab is hidden** – countdown continues while tab is out of focus.                                                                                                                    | Start a round; switch to another browser tab for ~5 seconds; return. The countdown has decreased by ~5 seconds even though the game was not visible.                                                                                                                                                                 | Violates the requirement that timers pause on tab hide; players may lose turns inadvertently.                     |
| **Confusing dual timers** – the top score bar shows “Time Left: xx s” while the main area shows “Time remaining: xx”, and these often fall out of sync.                                                         | Start a match; observe that the “Time remaining” text and the scoreboard’s “Time Left” differ after toggling help or switching tabs.                                                                                                                                                                                 | Redundant and inconsistent information; can mislead players or screen‑reader users.                               |
| **Verbose mode unclear** – toggling the “Verbose” checkbox does not visibly expose a log panel; no instructions indicate how to view logs.                                                                      | In a match, check the “Verbose” toggle. No log area appears, and it’s not clear how to access verbose data.                                                                                                                                                                                                          | PRD calls for a verbose log view with timestamps; lacking this reduces observability for debugging/testing.       |
| **Quit resets match but leaves round counter** – after quitting mid‑match, returning to CLI shows `Round 0` but previous match’s round number temporarily flashes until a new match starts.                     | Start a match, play several rounds, quit, then return. The header shows `Round n` where `n` is from the previous match until the next round begins.                                                                                                                                                                  | Minor UX bug; could confuse players about whether a new match has started.                                        |
| **Keyboard shortcuts persist in wrong states** – pressing number keys before the match starts changes the win target value silently.                                                                            | On the initial screen, press `1`, `2` or `3`. The “Win target” dropdown changes accordingly (5, 10 or 15) without any modal or confirmation.                                                                                                                                                                         | Unintended coupling between match‑length selection and round controls; may result in accidental settings changes. |

Improvement opportunities
Add explicit “Start match” button – replace or accompany the tiny power icon with a clearly labelled button that is focusable via keyboard. Provide instructions (“Press Enter to start”) and ensure the first focused element triggers the start when Enter is pressed.
Include 3‑point option – align the win target selector with PRD by providing options 3, 5 and 10. Remove 15 unless explicitly supported.
Persist settings and seed – use localStorage to remember the last chosen win target and seed. Pre‑populate the seed input with the stored value and auto‑enable determinism.
Fix deterministic seed logic – ensure that the same seed and win target produce identical stat sequences across matches. Provide a URL parameter (e.g., ?seed=42) to simplify reproduction and shareable links.
Pause timers on tab hide – listen for the visibilitychange event and pause/resume countdowns accordingly. This prevents players from losing time when switching tabs.
Unify timer display – show only one countdown timer in the terminal area and remove the duplicate in the top bar, or ensure both always reflect the same remaining time.
Improve verbose mode – when the “Verbose” toggle is enabled, reveal a scrolling log area that prints state transitions and timestamps. Include a link in the help panel to explain verbose mode.
Clarify match‑length selection – if number keys change win target before a match has started, display a modal or message (“Select match length: Quick, Medium, Long”) to match the PRD’s quick/medium/long flow. Prevent accidental changes once the match begins.
Enhance accessibility feedback – ensure focus states are visually distinct (e.g., high‑contrast outlines), and that screen readers announce state changes such as “Round started” or “You selected Power 8”. Adding keyboard shortcuts to control the help panel and settings collapse would also aid navigation.

